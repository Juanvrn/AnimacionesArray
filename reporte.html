<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Brainrots (Offline V2)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        h1, h2, h3 {
            color: #2c3e50;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
        }
        h1 { font-size: 2em; }
        h2 { font-size: 1.5em; margin-top: 30px; }
        h3 { font-size: 1.2em; color: #34495e; border-bottom: none; margin-top: 20px; }

        /* --- (NUEVO) Estilos de Estadísticas --- */
        #summary-stats {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            border: 1px solid #dfe6e9;
        }
        #summary-stats p {
            margin: 5px 15px;
            font-size: 1em;
            color: #34495e;
            font-weight: 500;
            text-align: center;
        }
        #summary-stats strong {
            font-size: 1.4em;
            color: #2c3e50;
            display: block; /* Para que el número quede debajo */
            margin-top: 4px;
        }
        /* --- Fin Estilos Estadísticas --- */


        /* --- Estilos del Buscador --- */
        .search-container {
            position: relative; /* Clave para posicionar las sugerencias */
            margin-bottom: 20px;
        }
        #brainrot-search {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            box-sizing: border-box; /* Para que el padding no afecte el ancho */
        }
        #suggestions-box {
            position: absolute;
            top: 100%; /* Justo debajo del input */
            left: 0;
            width: 100%;
            border: 1px solid #dfe6e9;
            border-top: none;
            background-color: white;
            z-index: 10;
            max-height: 250px;
            overflow-y: auto;
            box-shadow: 0 5px 10px rgba(0,0,0,0.1);
            border-radius: 0 0 4px 4px;
            box-sizing: border-box;
        }
        .suggestion-item {
            padding: 10px 12px;
            cursor: pointer;
        }
        .suggestion-item:hover, .suggestion-item.active {
            background-color: #3498db; /* Azul, como en la imagen */
            color: white;
        }
        #search-results {
            margin-top: 15px;
            padding: 15px;
            background-color: #fafafa;
            border-radius: 4px;
            border: 1px solid #ecf0f1;
        }
        #search-results ul {
            margin-top: 10px;
            padding-left: 20px;
        }
        /* --- Fin Estilos Buscador --- */


        #user-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 15px;
            background-color: #ecf0f1;
            border-radius: 8px;
        }
        #user-buttons button {
            background-color: #3498db;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            font-size: 0.95em;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: 500;
        }
        #user-buttons button:hover {
            background-color: #2980b9;
        }
        #user-buttons button.active {
            background-color: #e74c3c; /* Botón activo en rojo */
        }
        
        #user-list-container ul {
            list-style-type: disc;
            padding-left: 20px;
        }
        #user-list-container li {
            margin-bottom: 8px;
            background-color: #fdfdfd;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #eee;
        }
        .category {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-left: 8px;
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #dfe6e9;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #ecf0f1;
            color: #34495e;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .no-results {
            color: #95a5a6;
            font-style: italic;
            padding: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Reporte de Brainrots (Offline V2)</h1>

        <div id="summary-stats">
            </div>

        <h2>Buscar Brainrot (Quién lo tiene)</h2>
        <div class="search-container">
            <input type="text" id="brainrot-search" placeholder="Escribe el nombre de un brainrot..." autocomplete="off">
            <div id="suggestions-box">
                </div>
        </div>
        <div id="search-results">
            </div>

        <h2>Selecciona un usuario para ver su lista</h2>
        <div id="user-buttons">
            </div>
        <div id="user-list-container">
            </div>
        
        <div id="duplicates-container">
            <h2 id="msg"></h2>
            <div id="duplicates-content">
                </div>
        </div>
    </div>

    <script>
        // --- BASE DE DATOS (Hardcodeada en Arrays) ---
        // (Datos extraídos de tu SQL)

const db_usuarios = [
    { id: 21, dueño: 'juanvrn30' },
    { id: 22, dueño: 'juanvrn31' },
    { id: 23, dueño: 'juanvrn32' },
    { id: 24, dueño: 'juanvrn33' },
    { id: 25, dueño: 'juanvrn34' },
    { id: 26, dueño: 'juanvrn35' },
    { id: 27, dueño: 'juanvrn36' },
    { id: 32, dueño: 'juanvrn37' },
    { id: 33, dueño: 'juanvrn38' },
];

const db_brainrots_usuario = [
    { userId: 25, brId: 24 },
    { userId: 25, brId: 17 },
    { userId: 25, brId: 20 },
    { userId: 25, brId: 59 },
    { userId: 25, brId: 45 },
    { userId: 25, brId: 6 },
    { userId: 25, brId: 73 },
    { userId: 25, brId: 78 },
    { userId: 22, brId: 63 },
    { userId: 22, brId: 89 },
    { userId: 22, brId: 86 },
    { userId: 22, brId: 87 },
    { userId: 22, brId: 40 },
    { userId: 22, brId: 88 },
    { userId: 22, brId: 58 },
    { userId: 22, brId: 14 },
    { userId: 22, brId: 46 },
    { userId: 22, brId: 72 },
    { userId: 22, brId: 53 },
    { userId: 22, brId: 81 },
    { userId: 22, brId: 41 },
    { userId: 22, brId: 82 },
    { userId: 22, brId: 29 },
    { userId: 22, brId: 84 },
    { userId: 22, brId: 83 },
    { userId: 22, brId: 62 },
    { userId: 22, brId: 85 },
    { userId: 22, brId: 5 },
    { userId: 22, brId: 1 },
    { userId: 21, brId: 12 },
    { userId: 21, brId: 7 },
    { userId: 21, brId: 90 },
    { userId: 21, brId: 52 },
    { userId: 21, brId: 4 },
    { userId: 21, brId: 91 },
    { userId: 21, brId: 49 },
    { userId: 21, brId: 11 },
    { userId: 21, brId: 13 },
    { userId: 21, brId: 31 },
    { userId: 21, brId: 92 },
    { userId: 21, brId: 48 },
    { userId: 21, brId: 43 },
    { userId: 21, brId: 37 },
    { userId: 21, brId: 93 },
    { userId: 21, brId: 94 },
    { userId: 21, brId: 65 },
    { userId: 21, brId: 95 },
    { userId: 21, brId: 75 },
    { userId: 21, brId: 84 },
    { userId: 21, brId: 39 },
    { userId: 23, brId: 15 },
    { userId: 23, brId: 96 },
    { userId: 23, brId: 4 },
    { userId: 23, brId: 54 },
    { userId: 23, brId: 97 },
    { userId: 23, brId: 98 },
    { userId: 23, brId: 68 },
    { userId: 23, brId: 99 },
    { userId: 23, brId: 25 },
    { userId: 23, brId: 100 },
    { userId: 23, brId: 101 },
    { userId: 23, brId: 66 },
    { userId: 23, brId: 56 },
    { userId: 23, brId: 69 },
    { userId: 23, brId: 2 },
    { userId: 23, brId: 102 },
    { userId: 23, brId: 55 },
    { userId: 23, brId: 36 },
    { userId: 23, brId: 103 },
    { userId: 23, brId: 64 },
    { userId: 23, brId: 104 },
    { userId: 24, brId: 105 },
    { userId: 24, brId: 106 },
    { userId: 24, brId: 107 },
    { userId: 24, brId: 8 },
    { userId: 24, brId: 108 },
    { userId: 24, brId: 109 },
    { userId: 24, brId: 110 },
    { userId: 24, brId: 111 },
    { userId: 24, brId: 112 },
    { userId: 24, brId: 39 },
    { userId: 24, brId: 1 },
    { userId: 24, brId: 64 },
    { userId: 24, brId: 118 },
    { userId: 24, brId: 119 },
    { userId: 24, brId: 120 },
    { userId: 24, brId: 121 },
    { userId: 24, brId: 113 },
    { userId: 24, brId: 114 },
    { userId: 24, brId: 115 },
    { userId: 24, brId: 116 },
    { userId: 24, brId: 117 },
    { userId: 25, brId: 122 },
    { userId: 25, brId: 123 },
    { userId: 25, brId: 124 },
    { userId: 25, brId: 125 },
    { userId: 25, brId: 128 },
    { userId: 25, brId: 127 },
    { userId: 25, brId: 126 },
    { userId: 25, brId: 32 },
    { userId: 25, brId: 9 },
    { userId: 25, brId: 51 },
    { userId: 25, brId: 30 },
    { userId: 25, brId: 129 },
    { userId: 25, brId: 74 },
    { userId: 26, brId: 130 },
    { userId: 26, brId: 57 },
    { userId: 26, brId: 131 },
    { userId: 26, brId: 33 },
    { userId: 26, brId: 132 },
    { userId: 26, brId: 133 },
    { userId: 26, brId: 47 },
    { userId: 26, brId: 134 },
    { userId: 26, brId: 19 },
    { userId: 26, brId: 34 },
    { userId: 26, brId: 138 },
    { userId: 26, brId: 139 },
    { userId: 26, brId: 140 },
    { userId: 26, brId: 42 },
    { userId: 26, brId: 141 },
    { userId: 26, brId: 135 },
    { userId: 26, brId: 136 },
    { userId: 26, brId: 137 },
    { userId: 26, brId: 70 },
    { userId: 26, brId: 35 },
    { userId: 26, brId: 80 },
    { userId: 27, brId: 147 },
    { userId: 27, brId: 148 },
    { userId: 27, brId: 28 },
    { userId: 27, brId: 149 },
    { userId: 27, brId: 150 },
    { userId: 27, brId: 22 },
    { userId: 27, brId: 151 },
    { userId: 27, brId: 152 },
    { userId: 27, brId: 79 },
    { userId: 27, brId: 142 },
    { userId: 27, brId: 61 },
    { userId: 27, brId: 144 },
    { userId: 27, brId: 157 },
    { userId: 27, brId: 158 },
    { userId: 27, brId: 143 },
    { userId: 27, brId: 159 },
    { userId: 27, brId: 160 },
    { userId: 27, brId: 153 },
    { userId: 27, brId: 156 },
    { userId: 27, brId: 162 },
    { userId: 27, brId: 146 },
    { userId: 32, brId: 163 },
    { userId: 32, brId: 173 },
    { userId: 32, brId: 169 },
    { userId: 32, brId: 170 },
    { userId: 32, brId: 171 },
    { userId: 32, brId: 44 },
    { userId: 32, brId: 172 },
    { userId: 32, brId: 10 },
    { userId: 32, brId: 145 },
    { userId: 32, brId: 165 },
    { userId: 32, brId: 166 },
    { userId: 32, brId: 167 },
    { userId: 32, brId: 76 },
    { userId: 32, brId: 168 },
    { userId: 32, brId: 67 },
    { userId: 32, brId: 174 },
    { userId: 32, brId: 175 },
    { userId: 32, brId: 176 },
    { userId: 32, brId: 177 },
    { userId: 32, brId: 178 },
    { userId: 32, brId: 179 },
    { userId: 33, brId: 71 },
    { userId: 33, brId: 164 },
    { userId: 33, brId: 155 },
    { userId: 33, brId: 180 },
    { userId: 33, brId: 181 },
    { userId: 33, brId: 186 },
    { userId: 33, brId: 185 },
    { userId: 33, brId: 184 },
    { userId: 33, brId: 183 },
    { userId: 33, brId: 182 },
    { userId: 33, brId: 187 },
    { userId: 33, brId: 188 },
    { userId: 33, brId: 189 },
    { userId: 33, brId: 190 },
];

const db_brainrots = [
    { id: 1, nombre: 'Tralalero Tralala', Categoria: 'Brainrot God' },
    { id: 2, nombre: 'Los Bombinitos ', Categoria: 'Brainrot God' },
    { id: 4, nombre: 'Extinct Ballerina', Categoria: 'Brainrot God' },
    { id: 5, nombre: 'Trenostruzzo Turbo 3000', Categoria: 'Brainrot God' },
    { id: 6, nombre: 'Odin Din Din Dun', Categoria: 'Brainrot God' },
    { id: 7, nombre: 'Pakrahmatmamat', Categoria: 'Brainrot God' },
    { id: 8, nombre: 'Ta Ta Ta Ta Sahur', Categoria: 'Rare' },
    { id: 9, nombre: 'Ballerina Cappuccina', Categoria: 'Legendary' },
    { id: 10, nombre: 'Extinct Tralalero', Categoria: 'Secret' },
    { id: 11, nombre: 'Alessio', Categoria: 'Brainrot God' },
    { id: 12, nombre: 'Girafa Celestre', Categoria: 'Brainrot God' },
    { id: 13, nombre: 'Bombardiro Crocodilo', Categoria: 'Mythic' },
    { id: 14, nombre: 'Tukanno Bananno', Categoria: 'Brainrot God' },
    { id: 15, nombre: 'Sammyni Spyderini', Categoria: 'Secret' },
    { id: 17, nombre: 'Matteo', Categoria: 'Brainrot God' },
    { id: 19, nombre: 'Orcalero Orcala', Categoria: 'Brainrot God' },
    { id: 20, nombre: 'Gattio Tacoto', Categoria: 'Brainrot God' },
    { id: 22, nombre: 'Carloo', Categoria: 'Mythic' },
    { id: 24, nombre: 'Zibra Zubra Zibralini', Categoria: 'Mythic' },
    { id: 25, nombre: 'Los Crocodillitos', Categoria: 'Brainrot God' },
    { id: 28, nombre: 'Tigreligre Frutonni', Categoria: 'Brainrot God' },
    { id: 29, nombre: 'Los Orcalitos', Categoria: 'Brainrot God' },
    { id: 30, nombre: 'Cacasito Satalito', Categoria: 'Brainrot God' },
    { id: 31, nombre: 'La Vacca Saturno Saturnita', Categoria: 'Secret' },
    { id: 32, nombre: 'Bombardini Tortinii', Categoria: 'Brainrot God' },
    { id: 33, nombre: 'Chihuanini Taconini', Categoria: 'Brainrot God' },
    { id: 34, nombre: 'Tipi Topi Taco', Categoria: 'Brainrot God' },
    { id: 35, nombre: 'Ballerino Lololo', Categoria: 'Brainrot God' },
    { id: 36, nombre: 'Karkerkur Kurkur', Categoria: 'Secret' },
    { id: 37, nombre: 'Cocofanto Elefanto', Categoria: 'Brainrot God' },
    { id: 39, nombre: 'Trippi Troppi Troppa Trippa', Categoria: 'Brainrot God' },
    { id: 40, nombre: 'Dul Dul Dul', Categoria: 'Secret' },
    { id: 41, nombre: 'Frigo Camelo', Categoria: 'Mythic' },
    { id: 42, nombre: 'La Karkekar Combinasion', Categoria: 'Secret' },
    { id: 43, nombre: 'Graipuss Medussi', Categoria: 'Secret' },
    { id: 44, nombre: 'Bisonte Giuppitere', Categoria: 'Secret' },
    { id: 45, nombre: 'Crabbo Limonetta', Categoria: 'Brainrot God' },
    { id: 46, nombre: 'Piccione Macchina', Categoria: 'Brainrot God' },
    { id: 47, nombre: 'Spionero Golubiro', Categoria: 'Mythic' },
    { id: 48, nombre: 'Los Tungtungtungcitos', Categoria: 'Brainrot God' },
    { id: 49, nombre: 'Job Job Job Sahur', Categoria: 'Secret' },
    { id: 51, nombre: 'Tracoducotulu Delapeladustuz', Categoria: 'Mythic' },
    { id: 52, nombre: 'Te Te Te Sahur', Categoria: 'Mythic' },
    { id: 53, nombre: 'Las Tralaleritas', Categoria: 'Secret' },
    { id: 54, nombre: 'Las Capuchinas', Categoria: 'Brainrot God' },
    { id: 55, nombre: 'Chachechi', Categoria: 'Secret' },
    { id: 56, nombre: 'Torrtugini Dragonfrutini', Categoria: 'Secret' },
    { id: 57, nombre: 'Tralalita Tralala', Categoria: 'Brainrot God' },
    { id: 58, nombre: 'Blackhole Goat', Categoria: 'Secret' },
    { id: 59, nombre: 'Belula Beluga', Categoria: 'Brainrot God' },
    { id: 61, nombre: 'Capi Taco', Categoria: 'Brainrot God' },
    { id: 62, nombre: 'Los Tipi Tacos', Categoria: 'Brainrot God' },
    { id: 63, nombre: 'Tractoro Dinosauro', Categoria: 'Brainrot God' },
    { id: 64, nombre: 'Chef Crabracadabra', Categoria: 'Legendary' },
    { id: 65, nombre: 'Bombombini Gusini', Categoria: 'Mythic' },
    { id: 66, nombre: 'Guerriro Digitale', Categoria: 'Secret' },
    { id: 67, nombre: 'Orcalita Orcala', Categoria: 'Brainrot God' },
    { id: 68, nombre: 'Las Vaquitas Saturnitas', Categoria: 'Secret' },
    { id: 69, nombre: 'La Cucaracha', Categoria: 'Secret' },
    { id: 70, nombre: 'Esok Sekolah', Categoria: 'Secret' },
    { id: 71, nombre: 'La Sahur Combinasion', Categoria: 'Secret' },
    { id: 72, nombre: 'Los Tralaleritos', Categoria: 'Secret' },
    { id: 73, nombre: 'Corn Corn Corn Sahur', Categoria: 'Brainrot God' },
    { id: 74, nombre: 'Boneca Ambalabu', Categoria: 'Rare' },
    { id: 75, nombre: 'Noobini Pizzanini', Categoria: 'Common' },
    { id: 76, nombre: 'To to to Sahur', Categoria: 'Secret' },
    { id: 78, nombre: 'Perrito Burrito', Categoria: 'Secret' },
    { id: 79, nombre: 'Brasilini Berimbini', Categoria: 'Brainrot God' },
    { id: 80, nombre: 'Carrotini Brainini', Categoria: 'Brainrot God' },
    { id: 81, nombre: 'Tartaragno', Categoria: 'Common' },
    { id: 82, nombre: 'Chimpanzini Bananini', Categoria: 'Legendary' },
    { id: 83, nombre: 'Glorbo Fruttodrillo', Categoria: 'Legendary' },
    { id: 84, nombre: 'Cavallo Virtuoso', Categoria: 'Mythic' },
    { id: 85, nombre: 'Krupuk Pagi Pagi', Categoria: 'Brainrot God' },
    { id: 86, nombre: 'Bananita Dolphinita', Categoria: 'Epic' },
    { id: 87, nombre: 'Lionel Cactusell', Categoria: 'Legendary' },
    { id: 88, nombre: 'Los Karkeritos', Categoria: 'Secret' },
    { id: 89, nombre: 'Jacko Jack Jack', Categoria: 'Brainrot God' },
    { id: 90, nombre: 'Salamino Penguino', Categoria: 'Epic' },
    { id: 91, nombre: 'Los Nooo My Hotspotsitos', Categoria: 'Secret' },
    { id: 92, nombre: 'Cacto Hipopotamo', Categoria: 'Rare' },
    { id: 93, nombre: 'Brr Brr Patapim', Categoria: 'Epic' },
    { id: 94, nombre: 'Pandaccini Bananini', Categoria: 'Legendary' },
    { id: 95, nombre: 'Avocadini Guffo', Categoria: 'Epic' },
    { id: 96, nombre: 'Brri Brri Bicus Dicus Bombicus', Categoria: 'Epic' },
    { id: 97, nombre: 'Los Tortus', Categoria: 'Secret' },
    { id: 98, nombre: 'Los 67', Categoria: 'Secret' },
    { id: 99, nombre: 'Urubini Flamenguini', Categoria: 'Brainrot God' },
    { id: 100, nombre: 'Los Chicleteiras', Categoria: 'Secret' },
    { id: 101, nombre: 'Pot Hotspot', Categoria: 'Secret' },
    { id: 102, nombre: 'Orangutini Ananassini', Categoria: 'Mythic' },
    { id: 103, nombre: 'Bulbito Bandito Traktorito', Categoria: 'Brainrot God' },
    { id: 104, nombre: 'Svinina Bombardino', Categoria: 'Common' },
    { id: 105, nombre: 'Pipi Kiwi', Categoria: 'Common' },
    { id: 106, nombre: 'Bandito Bobrito', Categoria: 'Rare' },
    { id: 107, nombre: 'Fluriflura', Categoria: 'Common' },
    { id: 108, nombre: 'Cachorrito Melonito', Categoria: 'Mythic' },
    { id: 109, nombre: 'Lirili Larila', Categoria: 'Common' },
    { id: 110, nombre: 'Talpa Di Fero', Categoria: 'Common' },
    { id: 111, nombre: 'Rhino Toasterino', Categoria: 'Mythic' },
    { id: 112, nombre: 'Sigma Boy', Categoria: 'Legendary' },
    { id: 113, nombre: 'Gangster Footera', Categoria: 'Rare' },
    { id: 114, nombre: 'Trulimero Trulicina', Categoria: 'Epic' },
    { id: 115, nombre: 'Gorillo Watermelondrillo', Categoria: 'Mythic' },
    { id: 116, nombre: 'Trippi Troppi', Categoria: 'Rare' },
    { id: 117, nombre: 'Buho de Fuego', Categoria: 'Legendary' },
    { id: 118, nombre: 'Vampira Cappucina', Categoria: 'Brainrot God' },
    { id: 119, nombre: 'Cappuccino Assassino', Categoria: 'Rare' },
    { id: 120, nombre: 'Pinealotto Fruttarino', Categoria: 'Rare' },
    { id: 121, nombre: 'Lerulerulerule', Categoria: 'Mythic' },
    { id: 122, nombre: 'Avocadini Antilopini', Categoria: 'Epic' },
    { id: 123, nombre: 'Mummio Rappitto', Categoria: 'Epic' },
    { id: 124, nombre: 'Bambini Crostini', Categoria: 'Epic' },
    { id: 125, nombre: 'Blueberrinni Octopusini', Categoria: 'Legendary' },
    { id: 126, nombre: 'Toiletto Focaccino', Categoria: 'Mythic' },
    { id: 127, nombre: 'Vulturino Skeletono', Categoria: 'Secret' },
    { id: 128, nombre: 'Magi Ribbitini', Categoria: 'Mythic' },
    { id: 129, nombre: 'Strawberrelli Flamingelli', Categoria: 'Legendary' },
    { id: 130, nombre: 'Perochelle Lemonchello', Categoria: 'Epic' },
    { id: 131, nombre: 'Los Matteos', Categoria: 'Secret' },
    { id: 132, nombre: 'Chicleteira Bicicleteira', Categoria: 'Secret' },
    { id: 133, nombre: 'Quivioli Ameleonni', Categoria: 'Legendary' },
    { id: 134, nombre: 'Snailenzo', Categoria: 'Brainrot God' },
    { id: 135, nombre: 'Pipi Potato', Categoria: 'Legendary' },
    { id: 136, nombre: 'Quesadilla Crocodila', Categoria: 'Secret' },
    { id: 137, nombre: 'Tric Trac Baraboom', Categoria: 'Rare' },
    { id: 138, nombre: 'Frankentteo', Categoria: 'Secret' },
    { id: 139, nombre: 'Bambu Bambu Sahur', Categoria: 'Brainrot God' },
    { id: 140, nombre: 'Tim Cheese', Categoria: 'Common' },
    { id: 141, nombre: 'Pakrahmatmatina', Categoria: 'Brainrot God' },
    { id: 142, nombre: '67', Categoria: 'Secret' },
    { id: 143, nombre: 'Los Combinasionas', Categoria: 'Secret' },
    { id: 144, nombre: 'Tentacolo Tecnico', Categoria: 'Brainrot God' },
    { id: 145, nombre: 'Zombie Tralala', Categoria: 'Secret' },
    { id: 146, nombre: 'Boatito Auratito', Categoria: 'Secret' },
    { id: 147, nombre: 'Quesadilla Vampiro', Categoria: 'Secret' },
    { id: 148, nombre: 'Los Mobilis', Categoria: 'Secret' },
    { id: 149, nombre: 'La Grande Combinasion', Categoria: 'Secret' },
    { id: 150, nombre: 'Chipso and Queso', Categoria: 'Secret' },
    { id: 151, nombre: 'Jackorilla', Categoria: 'Secret' },
    { id: 152, nombre: 'Jacko Spaventosa', Categoria: 'Mythic' },
    { id: 153, nombre: 'Pumpkini Spyderini', Categoria: 'Secret' },
    { id: 155, nombre: 'Los Jobcitos', Categoria: 'Secret' },
    { id: 156, nombre: 'Trickolino', Categoria: 'Secret' },
    { id: 157, nombre: 'Mummy Ambalabu', Categoria: 'Brainrot God' },
    { id: 158, nombre: 'Mariachi Corazoni', Categoria: 'Secret' },
    { id: 159, nombre: 'Burbaloni Loliloli', Categoria: 'Legendary' },
    { id: 160, nombre: 'Skull Skull Skull', Categoria: 'Brainrot God' },
    { id: 162, nombre: 'Burrito Bandito', Categoria: 'Secret' },
    { id: 163, nombre: 'Mastodontico Telepiedone', Categoria: 'Brainrot God' },
    { id: 164, nombre: '1x1x1x1', Categoria: 'Secret' },
    { id: 165, nombre: 'Los Gattitos', Categoria: 'Brainrot God' },
    { id: 166, nombre: 'Los Chihuaninis', Categoria: 'Brainrot God' },
    { id: 167, nombre: 'Chicleteirina Bicicleteirina', Categoria: 'Secret' },
    { id: 168, nombre: 'Bananito Bandito', Categoria: 'Mythic' },
    { id: 169, nombre: 'Frogato Pirato', Categoria: 'Epic' },
    { id: 170, nombre: 'Pop Pop Sahur', Categoria: 'Brainrot God' },
    { id: 171, nombre: 'Aquanaut', Categoria: 'Brainrot God' },
    { id: 172, nombre: 'Wombo Rollo', Categoria: 'Epic' },
    { id: 173, nombre: 'Mieteteira Bicilceteira', Categoria: 'Secret' },
    { id: 174, nombre: 'Swag Soda', Categoria: 'Secret' },
    { id: 175, nombre: 'Los Spooky Combinasionas', Categoria: 'Secret' },
    { id: 176, nombre: 'Squalanana', Categoria: 'Brainrot God' },
    { id: 177, nombre: 'Granchiello Spiritell', Categoria: 'Brainrot God' },
    { id: 178, nombre: 'Los cucarachas', Categoria: 'Secret' },
    { id: 179, nombre: 'Money Money Puggy', Categoria: 'Secret' },
    { id: 180, nombre: 'Los quesadillas', Categoria: 'Secret' },
    { id: 181, nombre: 'Ketupat Kepat', Categoria: 'Secret' },
    { id: 182, nombre: 'Los burritos', Categoria: 'Secret' },
    { id: 183, nombre: 'Los Bros', Categoria: 'Secret' },
    { id: 184, nombre: 'Tacorita Bicicleta', Categoria: 'Secret' },
    { id: 185, nombre: 'Giftini Spyderini', Categoria: 'Secret' },
    { id: 186, nombre: 'La Spooky Grande', Categoria: 'Secret' },
    { id: 187, nombre: 'Horegini Boom', Categoria: 'Secret' },
    { id: 188, nombre: 'Telemorte', Categoria: 'Secret' },
    { id: 189, nombre: 'Gobblino Uniclino', Categoria: 'Secret' },
    { id: 190, nombre: 'La Taco Combinasion', Categoria: 'Secret' },
];


document.getElementById("msg").append("Brainrots Duplicados (entre estos "+ db_usuarios.length +" usuarios)");





        // --- LÓGICA DE LA APLICACIÓN ---

        // Mapas para búsquedas rápidas
        const userMap = new Map(db_usuarios.map(u => [u.id, u]));
        const brainrotMap = new Map(db_brainrots.map(b => [b.id, b]));

        // Referencias a los elementos del HTML
        const userButtonsContainer = document.getElementById('user-buttons');
        const userListContainer = document.getElementById('user-list-container');
        const duplicatesContent = document.getElementById('duplicates-content');
        const searchInput = document.getElementById('brainrot-search');
        const suggestionsBox = document.getElementById('suggestions-box');
        const searchResultsContainer = document.getElementById('search-results');

        
        // --- Lógica del Buscador (EXISTENTE) ---

        /**
         * Se activa cada vez que el usuario escribe en el input de búsqueda
         */
        function handleSearchInput(e) {
            const query = e.target.value.toLowerCase();
            suggestionsBox.innerHTML = ''; // Limpiar sugerencias anteriores

            if (query.length < 1) { // No mostrar nada si está vacío
                return;
            }

            // Filtrar la lista de brainrots
            const matches = db_brainrots.filter(br => 
                br.nombre.toLowerCase().includes(query)
            );

            // Mostrar solo los primeros 10 resultados
            matches.slice(0, 10).forEach(br => {
                const item = document.createElement('div');
                item.className = 'suggestion-item';
                item.textContent = br.nombre;
                // Acción al hacer clic en la sugerencia
                item.onclick = () => selectSuggestion(br.nombre);
                suggestionsBox.appendChild(item);
            });
        }

        /**
         * Se activa al hacer clic en una sugerencia
         */
        function selectSuggestion(brainrotName) {
            searchInput.value = brainrotName; // Poner el nombre en el input
            suggestionsBox.innerHTML = ''; // Limpiar y ocultar sugerencias
            performBrainrotSearch(brainrotName); // Realizar la búsqueda final
        }

        /**
         * Busca los dueños del brainrot seleccionado
         */
        function performBrainrotSearch(brainrotName) {
            // 1. Encontrar el ID del brainrot
            const brainrot = db_brainrots.find(br => br.nombre === brainrotName);
            
            if (!brainrot) {
                searchResultsContainer.innerHTML = `<p class="no-results">Brainrot no encontrado.</p>`;
                return;
            }
            
            const brId = brainrot.id;

            // 2. Encontrar los IDs de usuarios que lo tienen
            const ownerIds = db_brainrots_usuario
                .filter(item => item.brId === brId)
                .map(item => item.userId);
            
            // 3. Obtener IDs únicos (por si un usuario lo tiene repetido)
            const uniqueOwnerIds = [...new Set(ownerIds)];

            // 4. Mostrar los resultados
            if (uniqueOwnerIds.length === 0) {
                searchResultsContainer.innerHTML = `<p class="no-results">Ninguno de los ${db_usuarios.length} usuarios tiene <strong>${brainrotName}</strong>.</p>`;
            } else {
                // Mapear IDs a nombres
                const ownerNames = uniqueOwnerIds.map(id => userMap.get(id).dueño);
                
                let html = `<h3>Propietarios de <strong>${brainrotName}</strong>:</h3><ul>`;
                ownerNames.sort().forEach(name => {
                    html += `<li>${name}</li>`;
                });
                html += `</ul>`;
                searchResultsContainer.innerHTML = html;
            }
        }

        /**
         * (NUEVO) Limpia el buscador al hacer focus
         */
        function handleSearchFocus() {
            searchInput.value = ''; // Limpiar el input
            suggestionsBox.innerHTML = ''; // Limpiar sugerencias
        }

        // --- Lógica de Listas y Duplicados ---

        /**
         * (MODIFICADA) Muestra/Oculta la lista de brainrots para un usuario
         */
        function displayUserList(userId) {
            const clickedButton = document.querySelector(`button[data-userid="${userId}"]`);
            if (!clickedButton) return;

            // 1. Comprobar si ya estaba activo
            const isAlreadyActive = clickedButton.classList.contains('active');

            // 2. Limpiar la lista siempre
            userListContainer.innerHTML = '';

            // 3. Desactivar todos los botones
            document.querySelectorAll('#user-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });

            // 4. Si ya estaba activo, nos detenemos (efecto toggle-off)
            if (isAlreadyActive) {
                return;
            }

            // 5. Si no estaba activo, lo activamos y mostramos la lista
            clickedButton.classList.add('active');

            const user = userMap.get(userId);
            if (!user) return;

            const userBrainrotIds = db_brainrots_usuario
                .filter(item => item.userId === userId)
                .map(item => item.brId);
            
            const userBrainrots = userBrainrotIds
                .map(brId => brainrotMap.get(brId))
                .filter(br => br) // Filtrar nulos/indefinidos
                .sort((a, b) => a.nombre.localeCompare(b.nombre)); // Ordenar

            const h3 = document.createElement('h3');
            h3.textContent = `Lista de: ${user.dueño}`;
            userListContainer.appendChild(h3);

            if (userBrainrots.length === 0) {
                userListContainer.innerHTML += `<p class="no-results">Este usuario no tiene brainrots disponibles.</p>`;
                return;
            }

            const ul = document.createElement('ul');
            userBrainrots.forEach(br => {
                const li = document.createElement('li');
                const cat = (br.Categoria && br.Categoria.trim() !== '') ? br.Categoria : 'Sin Categoría';
                li.innerHTML = `<strong>${br.nombre}</strong> <span class="category">(${cat})</span>`;
                ul.appendChild(li);
            });
            userListContainer.appendChild(ul);
        }

        /**
         * Genera y muestra la tabla de duplicados (Sin cambios)
         */
        function displayDuplicates() {
            duplicatesContent.innerHTML = '';
            const brainrotOwnership = new Map();

            for (const item of db_brainrots_usuario) {
                if (!brainrotOwnership.has(item.brId)) {
                    brainrotOwnership.set(item.brId, new Set());
                }
                brainrotOwnership.get(item.brId).add(item.userId);
            }

            const duplicates = [];
            for (const [brId, userSet] of brainrotOwnership.entries()) {
                if (userSet.size > 1) {
                    const brainrot = brainrotMap.get(brId);
                    if (brainrot) { // Asegurarse de que el brainrot existe
                        const userNames = [...userSet]
                            .map(uid => userMap.get(uid).dueño)
                            .sort()
                            .join(', ');
                        
                        duplicates.push({
                            nombre: brainrot.nombre,
                            categoria: (brainrot.Categoria && brainrot.Categoria.trim() !== '') ? brainrot.Categoria : 'Sin Categoría',
                            usuarios: userNames
                        });
                    }
                }
            }

            if (duplicates.length === 0) {
                duplicatesContent.innerHTML = `<p class="no-results">No se encontraron duplicados entre estos ${db_usuarios.length} usuarios.</p>`;
                return;
            }

            duplicates.sort((a, b) => a.nombre.localeCompare(b.nombre));

            const table = document.createElement('table');
            table.innerHTML = `<thead><tr><th>Brainrot (Nombre)</th><th>Categoría</th><th>Usuarios que lo tienen</th></tr></thead>`;
            
            const tbody = document.createElement('tbody');
            duplicates.forEach(dup => {
                tbody.innerHTML += `<tr><td>${dup.nombre}</td><td>${dup.categoria}</td><td>${dup.usuarios}</td></tr>`;
            });

            table.appendChild(tbody);
            duplicatesContent.appendChild(table);
        }

        /**
         * (MODIFICADA) Función que se ejecuta cuando la página carga
         */
        function initialize() {

            // --- INICIO: NUEVO CÓDIGO DE ESTADÍSTICAS ---
            const summaryContainer = document.getElementById('summary-stats');

            // 1. Total de entradas (con duplicados)
            const totalConDuplicados = db_brainrots_usuario.length;
            
            // 2. Total de brainrots únicos en posesión
            const allOwnedBrainrotIds = db_brainrots_usuario.map(item => item.brId);
            const uniqueOwnedBrainrotIds = new Set(allOwnedBrainrotIds);
            const totalSinDuplicados = uniqueOwnedBrainrotIds.size;

            // 3. Total de brainrots definidos en la 'base de datos'
            const totalDefinidos = db_brainrots.length;

            summaryContainer.innerHTML = `
                <p>Total (con duplicados): <strong>${totalConDuplicados}</strong></p>
                <p>Únicos en posesión: <strong>${totalSinDuplicados}</strong></p>
                <p>Total Definidos: <strong>${totalDefinidos}</strong></p>
            `;
            // --- FIN: NUEVO CÓDIGO DE ESTADÍSTICAS ---


            // 1. Crear los botones de usuario
            db_usuarios.forEach(user => {
                const button = document.createElement('button');
                
                // --- MODIFICADO: Añadir contador al botón ---
                const userBrainrotCount = db_brainrots_usuario.filter(item => item.userId === user.id).length;
                button.textContent = `${user.dueño} (${userBrainrotCount})`;
                // --- FIN MODIFICACIÓN ---

                button.dataset.userid = user.id;
                button.addEventListener('click', () => displayUserList(user.id));
                userButtonsContainer.appendChild(button);
            });

            // 2. Generar el reporte de duplicados
            displayDuplicates();

            // 3. Añadir listeners al buscador
            searchInput.addEventListener('input', handleSearchInput);
            searchInput.addEventListener('focus', handleSearchFocus); // <-- AÑADIR ESTA LÍNEA

            // 4. Cerrar sugerencias si se hace clic fuera
            document.addEventListener('click', (e) => {
                // Si el clic NO fue en el contenedor del buscador
                if (!e.target.closest('.search-container')) {
                    suggestionsBox.innerHTML = '';
                }
            });
        }

        // Ejecutar la inicialización
        document.addEventListener('DOMContentLoaded', initialize);

    </script>
</body>
</html>
